# Creating New Pages

This guide covers creating new WordPress pages via the GitOps workflow.

## Overview

New pages are created by:
1. Creating a content file with YAML frontmatter
2. Pushing to GitHub
3. GitHub Actions automatically creates the page in WordPress and generates the meta JSON file

> ⚠️ **Important:** Never manually create meta JSON files. They are auto-generated by GitHub Actions after successful page creation. Manually created meta files will cause deployment failures.

## Step-by-Step Process

### 1. Create the Content File

Create a file in `content/pages/` with the `.txt` extension:

```bash
touch content/pages/my-new-page.txt
```

### 2. Add YAML Frontmatter

The file MUST start with YAML frontmatter containing at minimum `title` and `slug`:

```txt
---
title: My New Page Title
slug: my-new-page
status: publish
---
```

**Frontmatter Fields:**

| Field | Required | Default | Description |
|-------|----------|---------|-------------|
| `title` | Yes | - | Page title displayed in WordPress |
| `slug` | Yes | filename | URL slug (e.g., `my-page` → `/my-page/`) |
| `status` | No | `publish` | `publish`, `draft`, `pending`, or `private` |

### 3. Add Enfold Shortcode Content

After the closing `---`, add your Enfold shortcode content:

```txt
---
title: My New Page Title
slug: my-new-page
status: publish
---
[av_section min_height='' min_height_pc='25' min_height_px='500px' padding='default' shadow='no-border-styling' bottom_border='no-border-styling' id='' color='main_color' custom_bg='' background_gradient_color1='' background_gradient_color2='' background_gradient_direction='vertical' av-desktop-hide='' av-medium-hide='' av-small-hide='' av-mini-hide='' av_uid='av-12345']

[av_one_full first min_height='' vertical_alignment='av-align-top' space='' custom_margin='aviaTBcustom_margin' margin='0px' margin_sync='true' padding='0px' padding_sync='true' border='' border_color='' radius='0px' radius_sync='true' background_color='' av_uid='av-67890']

[av_heading heading='Welcome to My Page' tag='h1' style='blockquote modern-quote' size='' subheading_active='subheading_below' subheading_size='15' padding='10' color='' custom_font='' av_uid='av-abcde']This is my subtitle[/av_heading]

[av_textblock size='' font_color='' color='' av_uid='av-fghij']
<p>Your page content goes here.</p>
[/av_textblock]

[/av_one_full]

[/av_section]
```

### 4. Commit and Push

```bash
git add content/pages/my-new-page.txt
git commit -m "Add my new page"
git push origin staging
```

**Do NOT create or commit a meta file.** The workflow handles this automatically.

### 5. Verify

1. Check GitHub Actions for successful deployment
2. A `meta/pages/my-new-page.json` file will be auto-committed by the workflow
3. Visit `https://staging.example.com/my-new-page/` to verify

## Content Types

The workflow supports multiple content types based on the folder:

| Folder | WordPress Type | REST Endpoint |
|--------|---------------|---------------|
| `content/pages/` | Page | `/wp/v2/pages` |
| `content/posts/` | Post | `/wp/v2/posts` |
| `content/portfolio/` | Portfolio | `/wp/v2/portfolio` |
| `content/layouts/` | Enfold Layout | `/wp/v2/alb_custom_layout` |

## Template

Use this as a starting point:

```txt
---
title: PAGE_TITLE_HERE
slug: page-slug-here
status: publish
---
[av_section min_height='' min_height_pc='25' min_height_px='500px' padding='default' shadow='no-border-styling' bottom_border='no-border-styling' id='' color='main_color' custom_bg='' av_uid='']

[av_one_full first min_height='' vertical_alignment='av-align-top' space='' padding='0px' padding_sync='true' border='' border_color='' radius='0px' radius_sync='true' background_color='' av_uid='']

[av_heading heading='PAGE_TITLE_HERE' tag='h1' style='blockquote modern-quote' size='' subheading_active='' padding='10' color='' custom_font='' av_uid=''][/av_heading]

[av_textblock size='' font_color='' color='' av_uid='']
<p>Page content here.</p>
[/av_textblock]

[/av_one_full]

[/av_section]
```

## Common Mistakes to Avoid

### ❌ Don't manually create meta files

```bash
# WRONG - Never do this!
echo '{"post_id": 123}' > meta/pages/my-page.json
```

Meta files are auto-generated by GitHub Actions. Manually created ones will either:
- Cause "No post_id found" errors (if empty/invalid)
- Overwrite the wrong page (if ID is wrong)

### ❌ Don't commit content and meta files together

```bash
# WRONG - Don't create meta files yourself
git add content/pages/new-page.txt meta/pages/new-page.json
```

Only commit the content file. The workflow creates the meta file.

### ✅ Do only commit the content file

```bash
# CORRECT
git add content/pages/new-page.txt
git commit -m "Add new page"
git push origin staging
```

## Troubleshooting

### "Missing required field: title"

Ensure your file starts with valid YAML frontmatter:
```txt
---
title: Your Title
slug: your-slug
---
```

### Page created but content is wrong

Check that the content after `---` is valid Enfold shortcodes. Invalid shortcodes may render as plain text.

### Meta file not auto-committed

The workflow needs `permissions: contents: write`. Check the GitHub Actions logs for permission errors.

### Page created as draft

Ensure `status: publish` is in the frontmatter, or omit the status field (defaults to publish).

### "No post_id found in meta file" error

This means a meta file exists but is invalid. **Delete the meta file** and let the workflow recreate it:

```bash
git rm meta/pages/<page-name>.json
git commit -m "Remove invalid meta file"
git push origin staging
```
