# Enfold LLM - GitOps Plugin for WordPress/Enfold Sites

This Claude Code plugin enables GitOps workflows for WordPress sites using the Enfold theme. Manage page content and theme settings through version-controlled files deployed via GitHub Actions.

## ğŸš¨ Critical Workflow Rules

**This plugin implements a proven agentic development methodology:**

1. **NEVER manually create meta files** - Auto-generated by workflows
2. **NEVER push directly to main** - Always test on staging first  
3. **NEVER commit breaking changes to staging** - Use feature branches
4. **Use Git worktrees** for parallel Claude sessions
5. **Follow the branching strategy** - main â† staging â† feature/*

See `context/workflow-rules.md` for complete workflow documentation.

## Quick Start Commands

| Command | Purpose |
|---------|---------|
| `/wp-setup` | Initialize new project with plugin structure |
| `/wp-create-page` | Create a new page with Enfold shortcodes |
| `/wp-update-page` | Edit existing page content |
| `/wp-pull-page` | Sync content from WordPress to local files |
| `/wp-theme` | Update theme settings via design tokens |
| `/wp-status` | Check GitOps setup health |

## Working on GitHub Issues

When assigned a GitHub issue, follow this workflow:

### 1. Setup Worktree
```bash
git fetch origin
git worktree add Worktrees/<task-name> -b <type>/<task-name> origin/staging
cd Worktrees/<task-name>
```

Branch type conventions:
- `fix/` - Bug fixes
- `feature/` - New functionality  
- `cleanup/` - Refactoring, removing dead code, organizing
- `docs/` - Documentation only

### 2. Read the Issue
If given an issue number, fetch details with:
```bash
gh issue view <number>
```

### 3. Verify Setup
Always confirm before making changes:
```bash
pwd && git branch --show-current
```

### 4. Make Changes
- ONLY modify files within your assigned scope
- Do NOT touch files outside your scope
- Do NOT modify main or staging branches directly

### 5. Commit and PR
```bash
git add -A
git commit -m "<type>(<scope>): <description>"
git push origin HEAD
gh pr create --base staging --title "[Issue #<N>] <Title>"
```

Commit types: `feat`, `fix`, `chore`, `docs`, `refactor`

### 6. Report Back
Provide the PR URL when complete.

## How It Works

```
Local Files â”€â”€git pushâ”€â”€â–¶ GitHub Actions â”€â”€REST APIâ”€â”€â–¶ WordPress
     â”‚                           â”‚                         â”‚
content/*.txt                   â”‚                    Live Pages
theme/design-tokens.json        â”‚                Theme Settings
     â”‚                           â”‚                         â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Auto-generated meta/*.json â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Key Features

- **Version Control**: All content in git with full history
- **Staging Workflow**: Test changes on staging before production  
- **Design Tokens**: Theme settings as simple JSON
- **Auto Meta**: WordPress IDs auto-generated for new content
- **LLM Optimized**: Designed for AI assistant workflows

## Project Structure

After running `/wp-setup`:

```
your-site/
â”œâ”€â”€ .github/workflows/deploy.yml    # Deployment automation
â”œâ”€â”€ content/
â”‚   â”œâ”€â”€ pages/*.txt                # Page content (Enfold shortcodes) 
â”‚   â”œâ”€â”€ posts/*.txt                # Blog posts
â”‚   â””â”€â”€ portfolio/*.txt            # Portfolio items
â”œâ”€â”€ meta/
â”‚   â””â”€â”€ pages/*.json               # WordPress page IDs (auto-generated)
â”œâ”€â”€ scripts/                       # Deployment scripts
â”œâ”€â”€ theme/design-tokens.json       # Theme settings
â””â”€â”€ claude/                        # Documentation
```

## Deployment Flow

1. **Edit** content files or design tokens
2. **Commit** and push to `staging` branch  
3. **GitHub Actions** deploys to staging site
4. **Test** changes on staging environment
5. **Merge** to `main` branch for production deployment

## Agentic Development Patterns

This plugin implements battle-tested patterns for AI-assisted development:

### Git Worktrees for Parallel Work
```bash
# Multiple Claude sessions can work simultaneously
git worktree add Worktrees/feature-homepage feature/homepage
git worktree add Worktrees/fix-contact fix/contact-form
git worktree add Worktrees/import-blog import/blog-posts
```

### Feature Branch Workflow
```bash
# Always branch from staging
git checkout staging && git pull
git checkout -b feature/new-testimonials

# Work with clear commits
git add content/pages/testimonials.txt
git commit -m "feat(testimonials): Add customer stories"

# Create PR for review
git push origin HEAD
gh pr create --base staging
```

### Quality Gates
- Atomic commits with clear messages
- Test on staging before production
- PRs for significant changes
- Automated meta file generation
- No manual ID management

## Requirements

- WordPress 5.0+ with Enfold theme
- GitHub repository with Actions enabled
- WordPress Application Password
- Enfold REST Meta plugin (included)

## Installation

1. Run `/wp-setup` to copy template files
2. Install `wordpress/enfold-rest-meta/` plugin in WordPress
3. Configure GitHub Secrets: `USERNAME`, `APP_PASSWORD`  
4. Set GitHub Variables: `PRODUCTION_URL`, `STAGING_URL`

## Documentation

Complete documentation available in `context/claude/`:
- Creating and updating pages
- Enfold shortcode reference  
- Theme customization
- Troubleshooting guide

## Support

This plugin is designed for WordPress/Enfold sites with GitOps deployment. For issues or questions, refer to the troubleshooting guide in `context/claude/troubleshooting.md`.